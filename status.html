<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sunucu Durumu - berlinxrf.cfd</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://berlinxr.cfd/style.css">
    <style>
        ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        .section {
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            line-height: 1.6;
        }
        h1 {
            margin-bottom: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 25px;
        }
        table, th, td {
            border: 1px solid #ccc;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
    </style>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="logo">
                <img src="https://berlinxr.cfd/logox.png" alt="logo" style="width:48px;height:48px; border-radius: 50%;">
            </div>
            <ul class="nav-links">
                <li><a href="/">Ana Sayfa</a></li>
            </ul>
        </nav>
    </header>

    <section class="section">
        <h1>Sunucu Durumu</h1>
        <table id="statusTable">
            <tr><th>Bilgi Türü</th><th>Değer</th></tr>
            <tr><td colspan="2">Veriler yükleniyor...</td></tr>
        </table>
    </section>

    <footer>
        <p>&copy; 2025 berlinxrf.cfd. Tüm hakları saklıdır.</p>
    </footer>

    <script>
        const jsonURL = "https://next.berlinxr.cfd/ocs/v2.php/apps/serverinfo/api/v1/info?format=json";

        fetch(jsonURL)
            .then(res => res.json())
            .then(data => {
                const sys = data.ocs.data.nextcloud.system;
                const db = data.ocs.data.database;
                const php = data.ocs.data.server.php;
                const table = document.getElementById("statusTable");

                const totalRAM = (sys.mem_total / 1024 / 1024).toFixed(2) + " GB";
                const freeRAM = (sys.mem_free / 1024 / 1024).toFixed(2) + " GB";
                const usedRAM = ((sys.mem_total - sys.mem_free) / 1024 / 1024).toFixed(2) + " GB";
                const freeDisk = (sys.freespace / 1024 / 1024 / 1024).toFixed(0) + " GB";

                const rows = [
                    ["Toplam RAM", totalRAM],
                    ["Kullanılan RAM", usedRAM],
                    ["Boş RAM", freeRAM],
                    ["CPU Çekirdek Sayısı", sys.cpunum],
                    ["CPU Yükü (1/5/15 dk)", sys.cpuload.join(", ")],
                    ["İşletim Sistemi", db.version.split("on ")[1] || "Bilinmiyor"],
                    ["PHP Sürümü", php.version],
                    ["Web Sunucusu", data.ocs.data.server.webserver],
                    ["Veritabanı", db.version.split(" ")[0] + " " + db.version.split(" ")[1]],
                    ["Veritabanı Boyutu", (parseInt(db.size) / 1024 / 1024).toFixed(2) + " MB"],
                    ["Boş Depolama Alanı", freeDisk],
                    ["Uptime (Unix)", php.opcache_statistics.start_time]
                ];

                table.innerHTML = "<tr><th>Bilgi Türü</th><th>Değer</th></tr>";
                rows.forEach(([label, value]) => {
                    const tr = document.createElement("tr");
                    tr.innerHTML = `<td>${label}</td><td>${value}</td>`;
                    table.appendChild(tr);
                });
            })
            .catch(err => {
                document.getElementById("statusTable").innerHTML =
                    `<tr><td colspan="2">Veri alınamadı: ${err}</td></tr>`;
            });
    </script>
</body>
</html>